@startuml

#---------------------------------------------------------

package ui
end package

package simulator

#---------------------------------------------------------

class SimulationState 
SimulationState : +time : long
SimulationState : +waveModel : WaveModel
SimulationState : +compositePotential : CompositePotential
SimulationState : +oscillators : List

class SimulationUnits
SimulationState *-> "1" SimulationUnits
SimulationUnits : +timeScale : float
SimulationUnits : +timeUnits : string
SimulationUnits : +width : float
SimulationUnits : +height : float
SimulationUnits : +distanceUnits : string

note as N2
    The root object of all simulation state
end note

N2 .> SimulationState

#---------------------------------------------------------

package potentials

interface Potential 
Potential : +computePotential(i : int, j : int, time : int) : float
Potential : +enabled : bool

class CompositePotential
CompositePotential : +getPotential() : List

class SlitPotential
SlitPotential : +getPotential() : Potential
SlitPotential : +setEnabled(enabled : boolean) : void
SlitPotential : +setOneSlit() : void
SlitPotential : +setTwoSlits() : void

class WallPotential
WallPotential : +getPotential() : float

class VerticalSingleSlit
VerticalSingleSlit "1" ..> "1" CompositePotential : creates
VerticalSingleSlit "1" ..> "2" WallPotential : creates

class VerticalDoubleSlit
VerticalDoubleSlit "1" ..> "1" CompositePotential : creates
VerticalDoubleSlit "1" ..> "3" WallPotential : creates

class PrecomputedPotential
PrecomputedPotential : +PrecomputedPotential(potential : Potential, width : int, height : int)
PrecomputedPotential : +getPotential() : Potential
VerticalSingleSlit "1" ..> "1" PrecomputedPotential : creates
VerticalDoubleSlit "1" ..> "1" PrecomputedPotential : creates

class ConstantPotential
ConstantPotential : +getPotential() : float

SlitPotential "1" ...> "0..1" ConstantPotential : creates
SlitPotential "1" ...> "0..1" VerticalSingleSlit : creates
SlitPotential "1" ...> "0..1" VerticalDoubleSlit : creates

SimulationState "1" --> "1..*" CompositePotential : has

abstract class VerticalBarrier
Potential <|-- VerticalBarrier
VerticalBarrier : +slitSeparation : int
VerticalBarrier : +slitSize : int
VerticalBarrier : +thickness : int
VerticalBarrier : +getPotential() : float

VerticalBarrier <|-- VerticalSingleSlit
VerticalBarrier <|-- VerticalDoubleSlit

Potential <|- CompositePotential
Potential "0..*" <--o "1" CompositePotential

Potential <|-- PrecomputedPotential
Potential <|-- WallPotential
Potential <|-- SlitPotential
Potential <|-- ConstantPotential

end package

package waves

class Oscillator 
SimulationState "1" -> "1..2" Oscillator : has
Oscillator : +enabled :bool
Oscillator : +location : Pnt3
Oscillator : +amplitude : float
Oscillator : +period : float

class WaveModel
WaveModel : +potential : Potential
WaveModel : +propagate() : void
WaveModel : +setSourceValue(x : int, y : int, value : float) : void
SimulationState "1" -> "1" WaveModel

WaveModel --> CompositePotential : has
Oscillator "1" --> "1" WaveModel : has, updates
WaveModel -> Lattice : produces

class ClassicalWavePropagator
ClassicalWavePropagator : +potential : Potential
ClassicalWavePropagator : -prevLattice : Lattice
ClassicalWavePropagator : +ClassicalWavePropagator(potential : Potential)
ClassicalWavePropagator : +setBoundaryCondition(x : int, y : int, value : float) : void
ClassicalWavePropagator : +propagate(lattice : Lattice) : void

class DampedClassicalWavePropagator
DampedClassicalWavePropagator : -dampX : int
DampedClassicalWavePropagator : -dampY : int
DampedClassicalWavePropagator : +DampedClassicalWavePropagator(potential : Potential, dampX : int, dampY : int)

WaveModel "1" --> "1" ClassicalWavePropagator : has
WaveModel "1" ..> "1" DampedClassicalWavePropagator : creates
ClassicalWavePropagator "1" --> "2" Lattice : has, produces
ClassicalWavePropagator -> Potential : has

ClassicalWavePropagator <|- DampedClassicalWavePropagator

end package
end package

ui .> simulator

@enduml
